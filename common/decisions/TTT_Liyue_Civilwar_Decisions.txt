#this is a serious od decisions to remove other liyue warlord's core after defeat or annex them
#to release memory, protect player's CPU0 and prevent any potential bug(s)
#well it did seems not such attractive to players because these decisions don't have any actual benefits now
#so if you have better ideas such as transfer navy, unite at peace or recruit characters, you can also put them into these decisons.
#i'm really a caibi.
liyue_civil_war_decisions = {
	liyue_region_movement_cooldown = {
		priority = 100
		icon = hol_draw_up_staff_plans
		allowed = {
			is_nominate_liyue = yes
		}
		available = {
			hidden_trigger = {
				always = no
			}
		}
		activation = {
			OR = {
				has_global_flag = Liyue_Civil_War
				has_global_flag = Liyue_Civil_War_Coming
			}
		}
		is_good = no
		days_mission_timeout = 75
		visible = {
			OR = {
				has_global_flag = Liyue_Civil_War
				has_global_flag = Liyue_Civil_War_Coming
			}
		}
		fire_only_once = no
		cancel_trigger = {
			hidden_trigger = {
				NOT = {
					has_global_flag = Liyue_Civil_War
				}
				NOT = {
					has_global_flag = Liyue_Civil_War_Coming
				}
			}
		}
		timeout_effect = {
			hidden_effect = {
				activate_mission = liyue_region_movement_cooldown
				clr_country_flag = tlcw_1_clicked_nearly
				clr_country_flag = tlcw_2_clicked_nearly
				clr_country_flag = tlcw_3_clicked_nearly
				clr_country_flag = tlcw_4_clicked_nearly
				clr_country_flag = tlcw_5_clicked_nearly
			}
		}
		complete_effect = {
		}
	}
	#First Stage of Liyue Civil War ----- Northern
	#reverse mission against invaders
	#anti_ZDG_offensive_in_one_year = {
	#	priority = 10
	#	icon = generic_ignite_civil_war
	#	available = {
	#		custom_trigger_tooltip = {
	#			tooltip = we_have_defeat_ZDG_on_our_own
	#			ZDG = {
	#				exists = no
	#			}
	#		}
	#	}
	#	days_mission_timeout = 270
	#	fire_only_once = yes
	#	activation = {
	#		has_war_with = ZDG
	#		OR = {
	#			original_tag = XOG
	#			original_tag = XRG
	#		}
	#	}
	#	is_good = yes
	#	timeout_effect = {
	#		custom_effect_tooltip = anti_ZDG_we_win
	#	}
	#}
	#	#Xianren and Xiao Negotiate for peace
	#	northern_negotation = {
	#		icon = generic_civil_support
	#		
	#		visible = {
	#			tag = XRG
	#			is_subject = no
	#			XOG = { exists = yes }
	#			OR = {
	#				is_faction_leader = yes
	#				is_in_faction = no
	#			}
	#		}
	#		
	#		available = {
	#			XOG = { is_in_faction = no }
	#			custom_trigger_tooltip = {
	#				tooltip = ZDG_defeated_or_not_come
	#				ZDG = { exists = no }
	#				has_global_flag = zdg_has_come
	#			}
	#		}
	#
	#		fire_only_once = yes
	#
	#		ai_will_do = {
	#			base = 40
	#			#Important
	#		}
	#		
	#		cost = 40
	#		
	#		complete_effect = {
	#			effect_tooltip = {
	#				if = {
	#					limit = {
	#						XRG = { is_in_faction = no }
	#					}
	#					create_faction = "qunxianfangxian"
	#				}
	#				add_to_faction = XOG
	#			}
	#			hidden_effect = { XOG = { country_event = XRG_EVENTS_0.8 } }
	#			custom_effect_tooltip = they_must_agreed_to_procceed
	#		}
	#	}
	unify_northern = {
		icon = generic_civil_support
		visible = {
			OR = {
				tag = XRG
				tag = XOG
				has_country_flag = center_victor
			}
			OR = {
				is_faction_leader = yes
				is_in_faction = no
			}
			is_subject = no
			has_global_flag = Liyue_Civil_War
			has_global_flag = zdg_has_come
		}
		available = {
			ZDG = {
				exists = no
			}
			custom_trigger_tooltip = {
				tooltip = north_no_enemy
				XRG = {
					OR = {
						AND = {
							tag = ROOT
							is_subject = no
							OR = {
								is_faction_leader = yes
								is_in_faction = no
							}
						}
						AND = {
							NOT = {
								tag = ROOT
							}
							OR = {
								exists = no
								is_subject = yes
							}
						}
					}
				}
				XOG = {
					OR = {
						AND = {
							tag = ROOT
							is_subject = no
							OR = {
								is_faction_leader = yes
								is_in_faction = no
							}
						}
						AND = {
							NOT = {
								tag = ROOT
							}
							OR = {
								exists = no
								is_subject = yes
							}
						}
					}
				}
			}
		}
		fire_only_once = yes
		ai_will_do = {
			base = 200
			#Important
		}
		complete_effect = {
			add_stability = 0.1
			add_war_support = 0.1
			add_political_power = 200
			set_country_flag = north_victor
		}
	}
	#First Stage of Liyue Civil War ----- Central
	KQG_ready_to_attack_NNG = {
		priority = 10
		icon = generic_ignite_civil_war
		available = {
			hidden_trigger = {
				always = no
			}
		}
		days_mission_timeout = 90
		fire_only_once = yes
		activation = {
			NNG = {
				exists = yes
			}
			custom_trigger_tooltip = {
				tag = KQG
				NNG = {
					exists = yes
				}
				NOT = {
					has_global_flag = Liyue_Civil_War
				}
				has_war = no
			}
		}
		visible = {
			NNG = {
				exists = yes
			}
			custom_trigger_tooltip = {
				tag = KQG
				NNG = {
					exists = yes
				}
				NOT = {
					has_global_flag = Liyue_Civil_War
				}
				has_war = no
			}
		}
		war_with_on_timeout = NNG
		cancel_if_not_visible = yes
		is_good = no
		timeout_effect = {
			hidden_effect = {
				LYU = {
					country_event = {
						id = liyue.12
					}
				}
				KQG = { set_variable = { KQG_mobilise_time = 0 } }
				KQG = { add_ideas = { Liyue_Guiliyuan_Conflict } }
				NNG = { add_ideas = { Liyue_Guiliyuan_Conflict } }
			}
			effect_tooltip = {
				declare_war_on = {
					target = NNG
					type = annex_everything
				}
			}
		}
	}
	NNG_ready_to_attack_KQG = {
		priority = 10
		icon = generic_ignite_civil_war
		available = {
			hidden_trigger = {
				always = no
			}
		}
		days_mission_timeout = 90
		fire_only_once = yes
		activation = {
			KQG = {
				exists = yes
			}
			custom_trigger_tooltip = {
				OR = {
					tag = NNG
				}
				KQG = {
					exists = yes
				}
				NOT = {
					has_global_flag = Liyue_Civil_War
				}
				has_war = no
			}
		}
		visible = {
			KQG = {
				exists = yes
			}
			custom_trigger_tooltip = {
				OR = {
					tag = NNG
				}
				KQG = {
					exists = yes
				}
				NOT = {
					has_global_flag = Liyue_Civil_War
				}
				has_war = no
			}
		}
		war_with_on_timeout = KQG
		cancel_if_not_visible = yes
		is_good = no
		timeout_effect = {
			effect_tooltip = {
				declare_war_on = {
					target = KQG
					type = annex_everything
				}
			}
		}
	}
	unify_centre = {
		icon = generic_civil_support
		visible = {
			OR = {
				is_center_warlords = yes
				has_country_flag = north_victor
			}
			NOT = {
				has_country_flag = ready_for_another_round
			}
			has_global_flag = Liyue_Civil_War
		}
		available = {
			OR = {
				is_faction_leader = yes
				is_in_faction = no
			}
			custom_trigger_tooltip = {
				tooltip = center_no_enemy
				OR = {
					tag = NNG
					AND = {
						NOT = {
							tag = NNG
						}
						NNG = {
							all_owned_state = {
								OR = {
									state = 116
									state = 117
									is_controlled_by = ROOT
								}
							}
						}
					}
				}
				OR = {
					tag = KQG
					KQG = {
						exists = no
					}
				}
				OR = {
					tag = NNG
					tag = KQG
					has_country_flag = north_victor
				}
			}
		}
		fire_only_once = yes
		ai_will_do = {
			base = 1000
			#Really really important
		}
		complete_effect = {
			add_political_power = 200
			add_stability = 0.1
			add_war_support = 0.1
			hidden_effect = {
				if = {
					limit = {
						NOT = {
							tag = NNG
						}
					}
					if = {
						limit = {
							NNG = {
								exists = yes
							}
						}
						NNG = {
							add_political_power = -100
							add_stability = -0.25
							add_war_support = -0.25
							set_country_flag = defeated_ningguang
						}
						news_event = {
							id = global_news.10
							hours = 12
						}
						NNG = {
							transfer_units_fraction = {
								target = ROOT
								size = 0
								navy_ratio = 0.45
								keep_unit_leaders = { }
								keep_unit_leaders_trigger = {
									always = yes
								}
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = NNG
							NOT = {
								state = 116
							}
							NOT = {
								state = 117
							}
						}
						#ROOT = {
						#	transfer_state = PREV
						#}
						add_core_of = ROOT
					}
				}
			}
			set_country_flag = center_victor
		}
	}
	strike_liyue_default = {
		icon = default_battle
		available = {
		}
		state_target = yes
		target_trigger = {
			FROM = {
				has_state_flag = is_Liyues_territory
				is_capital = yes
				owner = {
					NOT = {
						tag = ROOT
					}
					NOT = {
						has_war_with = ROOT
					}
					NOT = {
						is_in_faction_with = ROOT
					}
					NOT = {
						is_subject_of = ROOT
					}
					OR = {
						any_neighbor_country = {
							tag = ROOT
						}
						tag = NNG
					}
					NOT = {
						has_non_aggression_pact_with = ROOT
					}
				}
			}
		}
		visible = {
			OR = {
				date > 2003.9.1
				AND = {
					tag = ZDG
					XOG = {
						OR = {
							exists = no
							is_subject_of = ZDG
						}
					}
					XRG = {
						OR = {
							exists = no
							is_subject_of = ZDG
						}
					}
				}
				has_country_flag = north_victor
				has_country_flag = center_victor
				AND = {
					tag = XRG
					ZDG = {
						exists = no
					}
					date > 2001.4.1					#Avoid too early war declaration
				}
				AND = {
					tag = XOG
					ZDG = {
						exists = no
					}
					has_country_flag = XOG_choose_unify_Liyue
				}
			}
			NOT = {
				has_country_flag = ready_for_another_round
			}
			NOT = { has_wargoal_against = FROM.owner }
		}
		fire_only_once = no
		cost = 25
		war_with_on_remove = FROM.owner
		days_remove = 60
		on_map_mode = map_only
		complete_effect = {
			FROM.owner = {
				country_event = {
					id = liyue_civil_war.101
				}
			}
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = FROM.owner
			}
		}
		ai_will_do = {
			base = 250
			modifier = {
				factor = 0
				surrender_progress > 0.2
			}
			modifier = {
				factor = 0.2
				has_war = yes
			}
			modifier = {
				factor = 0.1
				enemies_strength_ratio > 1
			}
		}
	}
	form_liyue_unify_front = {
		visible = {
			has_global_flag = liyue_in_danger
			NOT = {
				has_global_flag = liyue_unified
			}
			NOT = {
				tag = ZDG
			}
			ZDG = {
				has_country_flag = ZDG_15_flag
			}
		}
		fire_only_once = yes
		available = {
			is_subject = no
			OR = {
				is_faction_leader = yes
				is_in_faction = no
			}
			OR = {
				has_war_with = ZDG
				51 = {
					controller = {
						OR = {
							tag = ROOT
							is_ally_with = ROOT
						}
					}
				}
			}
		}
		ai_will_do = {
			base = 1000
			#Really really important
		}
		days_remove = 6
		war_with_on_remove = ZDG
		complete_effect = {
			set_global_flag = liyue_unified
			set_country_flag = ready_to_join_pact
			every_country = {
				limit = {
					is_in_faction_with = ROOT
				}
				set_country_flag = former_faction_members
			}
			if = {
				limit = {
					is_faction_leader = yes
				}
				dismantle_faction = yes
			}
			create_faction = Liyue_united_faction
			every_country = {
				limit = {
					has_country_flag = former_faction_members
				}
				ROOT = {
					add_to_faction = PREV
				}
				clr_country_flag = former_faction_members
			}
			every_country = {
				limit = {
					is_nominate_liyue = yes
					is_subject = no
					NOT = {
						tag = ZDG
					}
					NOT = {
						tag = ROOT
					}
					OR = {
						is_in_faction = no
						is_faction_leader = yes
					}
				}
				country_event = {
					id = liyue_civil_war.21
					days = 2
				}
			}
		}
		remove_effect = {
			country_event = {
				id = liyue_civil_war.9
			}
			effect_tooltip = {
				declare_war_on = {
					target = ZDG
					type = annex_everything
				}
			}
			custom_effect_tooltip = see_how_charmful_we_are
		}
	}
	
	#General purpose nuclear
	#defeat_all = {
		#move to military rebuild
	#}
	#General purpose nuclear_ANG
	ANG_defeat_all = {
		icon = generic_civil_support
		name = defeat_all
		cost = 0
		fire_only_once = no
		days_remove = 15
		visible = {
			original_tag = ANG
		}
		highlight_states = {
			highlight_states_trigger = {
				is_controlled_by = ROOT
				NOT = {
					is_core_of = ROOT
				}
				all_of_scopes = {
					array = core_countries
					exists = no
				}
			}
		}
		ai_will_do = {
			base = 1000
			#Really really important
		}
		available = {
			FROM = {
				compliance > 30
			}
		}
		state_target = yes
		on_map_mode = map_only
		target_trigger = {
			FROM = {
				is_controlled_by = ROOT
				NOT = {
					is_core_of = ROOT
				}
				all_of_scopes = {
					array = core_countries
					exists = no
				}
			}
		}
		remove_effect = {
			FROM = {
				if = {
					limit = {
						is_core_of = XRG
					}
					ROOT = {
						add_to_variable = {
							var = ANG_state_support_var_XRG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_XRG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_support_var_SHG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_SHG
							value = 40
						}
						custom_effect_tooltip = ANG_defeat_tooltip
					}
				}
				else_if = {
					limit = {
						is_core_of = RTG
					}
					ROOT = {
						add_to_variable = {
							var = ANG_state_support_var_RTG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_RTG
							value = 40
						}
						custom_effect_tooltip = ANG_defeat_tooltip
					}
				}
				else_if = {
					limit = {
						is_core_of = LYU
					}
					ROOT = {
						add_to_variable = {
							var = ANG_state_support_var_LYU
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_LYU
							value = 40
						}
						custom_effect_tooltip = ANG_defeat_tooltip
					}
				}
				else_if = {
					limit = {
						is_core_of = KQG
					}
					ROOT = {
						add_to_variable = {
							var = ANG_state_support_var_KQG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_KQG
							value = 40
						}
						custom_effect_tooltip = ANG_defeat_tooltip
					}
				}
				else_if = {
					limit = {
						is_core_of = NNG
					}
					ROOT = {
						add_to_variable = {
							var = ANG_state_support_var_NNG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_NNG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_support_var_BDG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_BDG
							value = 40
						}
						custom_effect_tooltip = ANG_defeat_tooltip
					}
				}
				else_if = {
					limit = {
						is_core_of = XOG
					}
					ROOT = {
						add_to_variable = {
							var = ANG_state_support_var_XOG
							value = 40
						}
						add_to_variable = {
							var = ANG_state_zhenghe_var_XOG
							value = 40
						}
						custom_effect_tooltip = ANG_defeat_tooltip
					}
				}
				every_possible_country = {
					limit = {
						FROM = {
							is_core_of = PREV
						}
					}
					FROM = {
						remove_core_of = PREV
					}
				}
			}
		}
	}
	#南方通用宣战决议
	Nanbu_xuanzhanjueyi_ANG = {
		#ANG宣战决议
		visible = {
			ANG = {
				exists = yes
			}
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			NOT = {
				ANG = {
					is_subject_of = ROOT
				}
				ANG = {
					is_in_faction_with = ROOT
				}
				ANG = {
					has_war_with = ROOT
				}
				tag = ANG
				has_wargoal_against = {
					target = ANG
					type = annex_everything
				}
			}
		}
		fire_only_once = no
		days_remove = 14
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = ANG
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = ANG
						}
					}
				}
			}
		}
		ai_will_do = {
			base = 100
		}
		war_with_on_complete = ANG
		complete_effect = {
			ANG = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = ANG
			}
		}
	}
	Nanbu_xuanzhanjueyi_RTG = {
		#RTG宣战决议
		visible = {
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			RTG = {
				exists = yes
			}
			NOT = {
				RTG = {
					is_subject_of = ROOT
				}
				RTG = {
					is_in_faction_with = ROOT
				}
				RTG = {
					has_war_with = ROOT
				}
				original_tag = RTG
				has_wargoal_against = {
					target = RTG
					type = annex_everything
				}
			}
		}
		fire_only_once = no
		days_remove = 14
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = RTG
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = RTG
						}
					}
				}
			}
		}
		ai_will_do = {
			base = 100
		}
		war_with_on_complete = RTG
		complete_effect = {
			RTG = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
			set_country_flag = Liyue_Declare_War_on_others
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = RTG
			}
		}
	}
	Nanbu_xuanzhanjueyi_XRG = {
		#XRG宣战决议
		visible = {
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			XRG = {
				exists = yes
			}
			NOT = {
				XRG = {
					is_subject_of = ROOT
				}
				XRG = {
					is_in_faction_with = ROOT
				}
				XRG = {
					has_war_with = ROOT
				}
				tag = XRG
				has_wargoal_against = {
					target = XRG
					type = annex_everything
				}
			}
		}
		fire_only_once = no
		days_remove = 14
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = XRG
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = XRG
						}
					}
				}
			}
		}
		ai_will_do = {
			base = 100
		}
		war_with_on_complete = XRG
		complete_effect = {
			XRG = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
			set_country_flag = Liyue_Declare_War_on_others
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = XRG
			}
		}
	}
	Nanbu_xuanzhanjueyi_XOG = {
		#XOG宣战决议
		visible = {
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			XOG = {
				exists = yes
			}
			NOT = {
				XOG = {
					is_subject_of = ROOT
				}
				XOG = {
					is_in_faction_with = ROOT
				}
				XOG = {
					has_war_with = ROOT
				}
				tag = XOG
				has_wargoal_against = {
					target = XOG
					type = annex_everything
				}
			}
		}
		fire_only_once = no
		days_remove = 14
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = XOG
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = XOG
						}
					}
				}
			}
		}
		war_with_on_complete = XOG
		ai_will_do = {
			base = 100
		}
		complete_effect = {
			XOG = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = XOG
			}
		}
	}
	Nanbu_xuanzhanjueyi_KQG = {
		#KQG宣战决议
		visible = {
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			KQG = {
				exists = yes
			}
			NOT = {
				KQG = {
					is_subject_of = ROOT
				}
				KQG = {
					is_in_faction_with = ROOT
				}
				KQG = {
					has_war_with = ROOT
				}
				tag = KQG
				has_wargoal_against = {
					target = KQG
					type = annex_everything
				}
			}
		}
		fire_only_once = yes
		days_remove = 14
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = KQG
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = KQG
						}
					}
				}
			}
		}
		ai_will_do = {
			base = 100
		}
		war_with_on_complete = KQG
		complete_effect = {
			set_country_flag = Liyue_Declare_War_on_others
			KQG = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = KQG
			}
		}
	}
	Nanbu_xuanzhanjueyi_NNG = {
		#NNG宣战决议
		visible = {
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			NNG = {
				exists = yes
			}
			NOT = {
				NNG = {
					is_subject_of = ROOT
				}
				NNG = {
					is_in_faction_with = ROOT
				}
				NNG = {
					has_war_with = ROOT
				}
				tag = NNG
				has_wargoal_against = {
					target = NNG
					type = annex_everything
				}
			}
		}
		fire_only_once = no
		days_remove = 14
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = NNG
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = NNG
						}
					}
				}
			}
		}
		war_with_on_complete = NNG
		ai_will_do = {
			base = 100
		}
		complete_effect = {
			NNG = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = NNG
			}
		}
	}
	Nanbu_xuanzhanjueyi_LYU = {
		#LYU宣战决议
		visible = {
			has_country_flag = Liyue_Nanbu_xuanzhan_flag
			LYU = {
				exists = yes
			}
			NOT = {
				LYU = {
					is_subject_of = ROOT
				}
				LYU = {
					is_in_faction_with = ROOT
				}
				LYU = {
					has_war_with = ROOT
				}
				tag = LYU
				has_wargoal_against = {
					target = LYU
					type = annex_everything
				}
			}
		}
		fire_only_once = no
		days_remove = 30
		available = {
			OR = {
				any_owned_state = {
					any_neighbor_state = {
						is_controlled_by = LYU
					}
				}
				any_subject_country = {
					any_owned_state = {
						any_neighbor_state = {
							is_controlled_by = LYU
						}
					}
				}
			}
		}
		war_with_on_complete = LYU
		ai_will_do = {
			base = 100
		}
		complete_effect = {
			LYU = {
				country_event = {
					days = 1
					id = liyue_civil_war.101
				}
			}
		}
		remove_effect = {
			create_wargoal = {
				type = annex_everything
				target = LYU
			}
		}
	}
	
	KQG_reunify_liyue = {
		#宣告璃月内战结束
		allowed = {
			original_tag = KQG
		}
		visible = {
			is_subject = no
		}
		available = {
			LYU = { exists = no }
			ANG = { exists = no }
			ZDG = { exists = no }
			RTG = { exists = no }
			NNG = { exists = no }
			XOG = { exists = no }
			XRG = { exists = no }
			ARF = { exists = no }
		}
		fire_only_once = yes
		cost = 0
		ai_will_do = {
			base = 500
		}
		complete_effect = {
			reset_core_of_liyue = yes
			KQG = {
				set_cosmetic_tag = PRL
				set_autonomy = {
					target = CUG
					autonomy_state = LYU_autonomus_states
				}
				hidden_effect = {
					country_event = { id = super.11 }
				}
			}
			KQG = {
				set_party_name = { 
					ideology = totalitarianism
					long_name = KQG_totalitarianism_party_pcw_long
					name = KQG_totalitarianism_party_pcw
				}
				set_party_name = { 
					ideology = communism
					long_name = KQG_communism_party_pcw_long
					name = KQG_communism_party_pcw
				}
				set_party_name = { 
					ideology = left_wing_anarchism
					long_name = KQG_left_wing_anarchism_party_pcw_long
					name = KQG_left_wing_anarchism_party_pcw
				}
				set_party_name = { 
					ideology = reformism
					long_name = KQG_reformism_party_pcw_long
					name = KQG_reformism_party_pcw
				}
				set_party_name = { 
					ideology = liberalism
					long_name = KQG_liberalism_party_pcw_long
					name = KQG_liberalism_party_pcw
				}
				set_party_name = { 
					ideology = authoritarianism
					long_name = KQG_authoritarianism_party_pcw_long
					name = KQG_authoritarianism_party_pcw
				}
				set_party_name = { 
					ideology = despotism
					long_name = KQG_despotism_party_pcw_long
					name = KQG_despotism_party_pcw
				}
				set_party_name = { 
					ideology = national_socialism
					long_name = KQG_national_socialism_party_pcw_long
					name = KQG_national_socialism_party_pcw
				}
				set_party_name = { 
					ideology = esotericism
					long_name = KQG_esotericism_party_pcw_long
					name = KQG_esotericism_party_pcw
				}
				set_party_name = { 
					ideology = hive_mind
					long_name = KQG_hive_mind_party_pcw_long
					name = KQG_hive_mind_party_pcw
				}
				
				hidden_effect = {
					set_popularities = {
						totalitarianism = 8
						communism = 37
						left_wing_anarchism = 6
						reformism = 16
						liberalism = 9
						authoritarianism = 10
						despotism = 6
						national_socialism = 3
						esotericism = 3
						hive_mind = 2
					}
				}
			}
			play_song = "SE_Keqing_victory"
		}
	}
}

post_liyue_civil_war_decision_category = {
	
	#economy decisions	
	lyu_invest_factory = {
		icon = GFX_decision_Factory_resolution_icon_small
		cost = 20
		fire_only_once = no
		days_remove = 45
		days_re_enable = 45

		modifier = {
			political_power_factor = -0.1
		}
		
		visible = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
			}
		}

		ai_will_do = {
			base = 200
		}
		
		complete_effect = {
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 2 }
		}
		
		remove_effect = {
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 2 }
			custom_effect_tooltip = lyu_eco_rebuild_progress_add_tt
			add_to_variable = { liyue_eco_reconstruction_progress = 4 }
			if = {
				limit = { NOT = { has_country_flag = factory_invested } }
				custom_effect_tooltip = lyu_factory_bankrupt_effect_decrease_tt
				set_country_flag = factory_invested
			}
		}
	}
	
	lyu_rebuild_countryside = {
		icon = GFX_decision_TTT_decision07
		cost = 50
		fire_only_once = no
		days_remove = 180
		days_re_enable = 180

		modifier = {
			stability_weekly = 0.003
			war_support_weekly = 0.003
		}
		
		available = {
			has_manpower > 200000
		}
		
		visible = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
			}
		}

		ai_will_do = {
			base = 200
		}
		
		complete_effect = {
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 1 }
			add_manpower = -200000
		}
		
		remove_effect = {
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 6 }
			custom_effect_tooltip = lyu_rebellion_prepare_days_add_tt
			add_to_variable = { LYU_days_rebellion_prepare_timeout = 4 }
			custom_effect_tooltip = lyu_eco_rebuild_big_progress_add_tt
			add_to_variable = { liyue_eco_reconstruction_progress = 15 }
			custom_effect_tooltip = lyu_mil_rebuild_progress_add_tt
			add_to_variable = { liyue_mil_reconstruction_progress = 7 }
			custom_effect_tooltip = lyu_adm_rebuild_progress_add_tt
			add_to_variable = { liyue_adm_reconstruction_progress = 4 }
			add_manpower = 200000
			if = {
				limit = { NOT = { has_country_flag = countryside_rebuild } }
				custom_effect_tooltip = lyu_factory_bankrupt_effect_decrease_tt
				custom_effect_tooltip = lyu_rebellion_prepare_effect_decrease_tt
				set_country_flag = countryside_rebuild
			}
		}
	}
	
	lyu_fix_port = {
		icon = GFX_decision_TTT_decision01
		cost = 35
		fire_only_once = no
		days_remove = 30
		days_re_enable = 60

		modifier = {
			stability_weekly = 0.003
			war_support_weekly = 0.003
			civilian_factory_use = 3
		}
		
		available = {
			num_of_civilian_factories_available_for_projects > 2
		}
		
		visible = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
			}
		}

		ai_will_do = {
			base = 200
		}
		
		complete_effect = {
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 2 }
		}
		
		remove_effect = {
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 4 }
			custom_effect_tooltip = lyu_eco_rebuild_big_progress_add_tt
			add_to_variable = { liyue_eco_reconstruction_progress = 7 }
			if = {
				limit = { NOT = { has_country_flag = port_fixed } }
				custom_effect_tooltip = lyu_factory_bankrupt_effect_decrease_tt
				set_country_flag = port_fixed
			}
		}
	}
	
	#military decisions
	lyu_restore_order = {
		icon = generic_civil_support

		custom_cost_trigger = {
			command_power > 20
		}
		
		custom_cost_text = decision_cost_CP_20_cp
		
		fire_only_once = no
		days_remove = 15
		visible = {
			is_nominate_liyue = yes
		}
		highlight_states = {
			highlight_states_trigger = {
				is_controlled_by = ROOT
				NOT = {
					is_core_of = ROOT
				}
			}
		}
		ai_will_do = {
			base = 50
		}
		available = {
			FROM = {
				OR = {
					compliance > 35
					impassable = yes
				}
			}
		}
		state_target = yes
		on_map_mode = map_only
		target_trigger = {
			FROM = {
				is_controlled_by = ROOT
				NOT = {
					is_core_of = ROOT
				}
				has_state_flag = is_Liyues_territory
			}
		}
		complete_effect = {
			add_command_power = -20
		}
		remove_effect = {
			FROM = {
				every_possible_country = {
					limit = {
						FROM = {
							is_core_of = PREV
						}
					}
					FROM = {
						remove_core_of = PREV
					}
				}
				add_core_of = ROOT
			}
			hidden_effect = {
				add_to_variable = { LYU_days_rebellion_prepare_timeout = 1 }
				add_to_variable = { liyue_adm_reconstruction_progress = 2 }
				add_to_variable = { liyue_mil_reconstruction_progress = 2 }
			}
		}
	}
	
	lyu_reorganize_milita = {
		custom_cost_trigger = {
			has_equipment = { infantry_equipment > 4999 }
			has_army_experience > 75
		}
		
		icon = GFX_decision_TTT_Recruit_icon_Small
		
		custom_cost_text = lyu_reorganize_milita_cost_tt
		
		fire_only_once = yes
		days_remove = 240
		
		visible = {
			OR = {
				has_idea = Liyue_nationwide_resistance_1
				has_idea = Liyue_nationwide_resistance_2
				has_idea = Liyue_nationwide_resistance_3
				has_idea = Liyue_nationwide_resistance_4
				has_idea = Liyue_nationwide_resistance_5
			}
		}
		
		ai_will_do = {
			base = 1000
		}

		complete_effect = {
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -5000
			}	
			army_experience = -75
		}
		
		remove_effect = {
			add_war_support = 0.1
			custom_effect_tooltip = lyu_rebellion_prepare_days_add_tt
			custom_effect_tooltip = lyu_mil_rebuild_big_progress_add_tt
			custom_effect_tooltip = lyu_rebellion_prepare_effect_decrease_tt
			add_to_variable = { LYU_days_rebellion_prepare_timeout = 15 }
			add_to_variable = { liyue_mil_reconstruction_progress = 30 }
			set_country_flag = lyu_reorganize_milita_flag
		}
	}
	
	lyu_kill_bandits = {
		icon = GFX_decision_POL_looming_peasants_strike

		custom_cost_trigger = {
			has_equipment = { infantry_equipment > 499 }
			command_power > 20
		}
		
		custom_cost_text = decision_cost_ie_500_cp_20
		
		fire_only_once = no
		days_remove = 15
		days_re_enable = 45
		
		visible = {
			OR = {
				has_idea = Liyue_nationwide_resistance_1
				has_idea = Liyue_nationwide_resistance_2
				has_idea = Liyue_nationwide_resistance_3
				has_idea = Liyue_nationwide_resistance_4
				has_idea = Liyue_nationwide_resistance_5
			}
		}
		
		ai_will_do = {
			base = 10
		}
		
		state_target = yes
		on_map_mode = map_only
		target_trigger = {
			FROM = {
				is_controlled_by = ROOT
				NOT = {
					is_core_of = ROOT
				}
				has_state_flag = is_Liyues_territory
			}
		}
		complete_effect = {
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -500
			}	
			add_command_power = -20
		}
		
		remove_effect = {
			FROM = {
				add_resistance = -10
				add_compliance = 10
			}
			hidden_effect = {
				add_to_variable = { LYU_days_rebellion_prepare_timeout = 1 }
				add_to_variable = { liyue_mil_reconstruction_progress = 2 }
			}
		}
	}
	
	#administration decisions
	lyu_recruit_more_officers = {
		icon = GFX_decision_TTT_decision04
		cost = 15
		
		visible = {
			OR = {
				has_idea = Liyue_low_efficiency_administration_1
				has_idea = Liyue_low_efficiency_administration_2
				has_idea = Liyue_low_efficiency_administration_3
				has_idea = Liyue_low_efficiency_administration_4
				has_idea = Liyue_low_efficiency_administration_5
			}
		}
		
		ai_will_do = {
			base = 15
		}
		
		available = {
			has_manpower > 3000
		}
		
		days_remove = 15
		days_re_enable = 15
		
		modifier = {
			political_power_factor = -0.15
		}
		
		remove_effect = {
			custom_effect_tooltip = lyu_rebellion_prepare_days_add_tt
			custom_effect_tooltip = lyu_adm_rebuild_progress_add_tt
			add_to_variable = { LYU_days_rebellion_prepare_timeout = 1 }
			add_to_variable = { liyue_adm_reconstruction_progress = 3 }
		}
	}
	
	lyu_absorb_former_gov_employees = {
		icon = GFX_decision_TTT_decision08
		cost = 0
		
		visible = {
			OR = {
				has_idea = Liyue_low_efficiency_administration_1
				has_idea = Liyue_low_efficiency_administration_2
				has_idea = Liyue_low_efficiency_administration_3
				has_idea = Liyue_low_efficiency_administration_4
				has_idea = Liyue_low_efficiency_administration_5
			}
		}
		
		ai_will_do = {
			base = 50
		}
		
		days_remove = 180
		
		modifier = {
			political_power_cost = 0.3
			drift_defence_factor = -0.25
			reformism_drift = 0.15
			communism_drift = 0.03
			liberalism_drift = 0.03
			authoritarianism_drift = 0.07
			despotism_drift = 0.02
		}
		
		remove_effect = {
			custom_effect_tooltip = lyu_adm_rebuild_big_progress_add_tt
			add_to_variable = { liyue_adm_reconstruction_progress = 15 }
		}
	}
	
	#other decisions
	lyu_repair_road = {
		cost = 40
		
		available = {
			num_of_civilian_factories_available_for_projects > 4
		}
		
		visible = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
				
				has_idea = Liyue_nationwide_resistance_1
				has_idea = Liyue_nationwide_resistance_2
				has_idea = Liyue_nationwide_resistance_3
				has_idea = Liyue_nationwide_resistance_4
				has_idea = Liyue_nationwide_resistance_5
				
				has_idea = Liyue_low_efficiency_administration_1
				has_idea = Liyue_low_efficiency_administration_2
				has_idea = Liyue_low_efficiency_administration_3
				has_idea = Liyue_low_efficiency_administration_4
				has_idea = Liyue_low_efficiency_administration_5
			}
		}
		
		ai_will_do = {
			base = 10
		}
		
		days_remove = 60
		
		modifier = {
			civilian_factory_use = 5
			repair_speed_factor = 0.35
		}
		
		remove_effect = {
			custom_effect_tooltip = lyu_adm_rebuild_progress_add_tt
			custom_effect_tooltip = lyu_eco_rebuild_progress_add_tt
			custom_effect_tooltip = lyu_mil_rebuild_progress_add_tt
			add_to_variable = { liyue_adm_reconstruction_progress = 4 }
			add_to_variable = { liyue_eco_reconstruction_progress = 4 }
			add_to_variable = { liyue_mil_reconstruction_progress = 4 }
			
			custom_effect_tooltip = lyu_factory_bankrupt_days_add_tt
			custom_effect_tooltip = lyu_rebellion_prepare_days_add_tt
			add_to_variable = { LYU_days_rebellion_prepare_timeout = 3 }
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 3 }
			
			if = {
				limit = { NOT = { has_country_flag = lyu_repair_road_flag } }
				set_country_flag = lyu_repair_road_flag
				custom_effect_tooltip = lyu_rebellion_prepare_effect_decrease_tt
			}
		}
	}
	
	#lyu_seek_for_immigrant_help = {
	#}
	
	lyu_stabilize_economy = {
		icon = GFX_decision_TTT_decision05
		cost = 0
		
		visible = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
			}
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = we_have_enough_eco_progress_tt
				if = {
					limit = { has_idea = Liyue_economic_collapse_1 }
					check_variable = { liyue_eco_reconstruction_progress > 19 }
				}
				else_if = {
					limit = { has_idea = Liyue_economic_collapse_2 }
					check_variable = { liyue_eco_reconstruction_progress > 39 }
				}
				else_if = {
					limit = { has_idea = Liyue_economic_collapse_3 }
					check_variable = { liyue_eco_reconstruction_progress > 59 }
				}
				else_if = {
					limit = { has_idea = Liyue_economic_collapse_4 }
					check_variable = { liyue_eco_reconstruction_progress > 79 }
				}
				else_if = {
					limit = { has_idea = Liyue_economic_collapse_5 }
					check_variable = { liyue_eco_reconstruction_progress > 99 }
				}
			}
		}
		ai_will_do = {
			factor = 1000
		}
		fire_only_once = no
		complete_effect = {
			liyue_eco_reconstruction_progress_upgrade = yes
			add_to_variable = { liyue_adm_reconstruction_progress = 1 }
			add_to_variable = { liyue_mil_reconstruction_progress = 1 }
			add_to_variable = { LYU_days_rebellion_prepare_timeout = 2 }
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 5 }
		}
	}
	
	lyu_stabilize_country = {
		icon = GFX_decision_category_default_battle
		cost = 0
		
		visible = {
			OR = {
				has_idea = Liyue_nationwide_resistance_1
				has_idea = Liyue_nationwide_resistance_2
				has_idea = Liyue_nationwide_resistance_3
				has_idea = Liyue_nationwide_resistance_4
				has_idea = Liyue_nationwide_resistance_5
			}
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = we_have_enough_mil_progress_tt
				if = {
					limit = { has_idea = Liyue_nationwide_resistance_1 }
					check_variable = { liyue_mil_reconstruction_progress > 19 }
				}
				else_if = {
					limit = { has_idea = Liyue_nationwide_resistance_2 }
					check_variable = { liyue_mil_reconstruction_progress > 39 }
				}
				else_if = {
					limit = { has_idea = Liyue_nationwide_resistance_3 }
					check_variable = { liyue_mil_reconstruction_progress > 59 }
				}
				else_if = {
					limit = { has_idea = Liyue_nationwide_resistance_4 }
					check_variable = { liyue_mil_reconstruction_progress > 79 }
				}
				else_if = {
					limit = { has_idea = Liyue_nationwide_resistance_5 }
					check_variable = { liyue_mil_reconstruction_progress > 99 }
				}
			}
		}
		ai_will_do = {
			factor = 1000
		}
		fire_only_once = no
		complete_effect = {
			liyue_mil_reconstruction_progress_upgrade = yes
			add_stability = 0.05
			add_war_support = 0.05
			add_to_variable = { LYU_days_rebellion_prepare_timeout = 10 }
			add_to_variable = { LYU_days_factory_bankrupt_timeuot = 2 }
			every_owned_state = {
				limit = {
					NOT = { is_core_of = ROOT }
				}
				add_resistance = -5
				add_compliance = 2
			}
		}
	}
	
	lyu_adm_expansion = {
		icon = GFX_decision_TTT_decision04
		cost = 0
		
		visible = {
			OR = {
				has_idea = Liyue_low_efficiency_administration_1
				has_idea = Liyue_low_efficiency_administration_2
				has_idea = Liyue_low_efficiency_administration_3
				has_idea = Liyue_low_efficiency_administration_4
				has_idea = Liyue_low_efficiency_administration_5
			}
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = we_have_enough_adm_progress_tt
				if = {
					limit = { has_idea = Liyue_low_efficiency_administration_1 }
					check_variable = { liyue_adm_reconstruction_progress > 19 }
				}
				else_if = {
					limit = { has_idea = Liyue_low_efficiency_administration_2 }
					check_variable = { liyue_adm_reconstruction_progress > 39 }
				}
				else_if = {
					limit = { has_idea = Liyue_low_efficiency_administration_3 }
					check_variable = { liyue_adm_reconstruction_progress > 59 }
				}
				else_if = {
					limit = { has_idea = Liyue_low_efficiency_administration_4 }
					check_variable = { liyue_adm_reconstruction_progress > 79 }
				}
				else_if = {
					limit = { has_idea = Liyue_low_efficiency_administration_5 }
					check_variable = { liyue_adm_reconstruction_progress > 99 }
				}
			}
		}
		ai_will_do = {
			factor = 1000
		}
		fire_only_once = no
		complete_effect = {
			liyue_adm_reconstruction_progress_upgrade = yes
			add_political_power = 100
			add_stability = 0.1
			add_war_support = 0.05
			every_owned_state = {
				limit = {
					NOT = { is_core_of = ROOT }
				}
				add_resistance = -2
				add_compliance = 5
			}
		}
	}
	
	liyue_factory_bankrupt = {
		activation = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
			}
		}
		available = {
			hidden_trigger = {
				always = no
			}
		}
		is_good = no
		days_mission_timeout = LYU_days_factory_bankrupt_timeuot
		visible = {
			OR = {
				has_idea = Liyue_economic_collapse_1
				has_idea = Liyue_economic_collapse_2
				has_idea = Liyue_economic_collapse_3
				has_idea = Liyue_economic_collapse_4
				has_idea = Liyue_economic_collapse_5
			}
		}
		fire_only_once = no
		cancel_trigger = {
			NOT = { has_idea = Liyue_economic_collapse_1 }
			NOT = { has_idea = Liyue_economic_collapse_2 }
			NOT = { has_idea = Liyue_economic_collapse_3 }
			NOT = { has_idea = Liyue_economic_collapse_4 }
			NOT = { has_idea = Liyue_economic_collapse_5 }
		}
		timeout_effect = {
			hidden_effect = {
				activate_mission = liyue_factory_bankrupt
			}
			random_list = {
				seed = global.date
				25 = {
					modifier = {
						add = -5
						has_country_flag = factory_invested
					}
					modifier = {
						add = -5
						has_country_flag = port_fixed
					}
					modifier = {
						add = -10
						has_country_flag = countryside_rebuild
					}
					random_owned_state = {
						limit = {
							industrial_complex > 0
						}
						remove_building = {
							type = industrial_complex
							level = 1
						}
					}
				}
				60 = {
					modifier = {
						add = -3
						has_country_flag = factory_invested
					}
					modifier = {
						add = -5
						has_country_flag = port_fixed
					}
					modifier = {
						add = -7
						has_country_flag = countryside_rebuild
					}
					random_owned_state = {
						limit = {
							arms_factory > 0
						}
						remove_building = {
							type = arms_factory
							level = 1
						}
					}
				}
				10 = {
					modifier = {
						add = -2
						has_country_flag = factory_invested
					}
					modifier = {
						add = -3
						has_country_flag = countryside_rebuild
					}
					modifier = {
						add = -5
						has_country_flag = port_fixed
					}
					random_owned_state = {
						limit = {
							dockyard > 0
						}
						remove_building = {
							type = dockyard
							level = 1
						}
					}
				}
				5 = {
					modifier = {
						add = 2
						has_country_flag = factory_invested
					}
					modifier = {
						add = 3
						has_country_flag = countryside_rebuild
					}
					modifier = {
						add = 5
						has_country_flag = port_fixed
					}
				}
			}
		}
		complete_effect = {
		}
	}

	liyue_rebellion_active = {
		activation = {
			OR = {
				has_idea = Liyue_nationwide_resistance_1
				has_idea = Liyue_nationwide_resistance_2
				has_idea = Liyue_nationwide_resistance_3
				has_idea = Liyue_nationwide_resistance_4
				has_idea = Liyue_nationwide_resistance_5
			}
		}
		available = {
			hidden_trigger = {
				always = no
			}
		}
		is_good = no
		days_mission_timeout = LYU_days_rebellion_prepare_timeout
		visible = {
			OR = {
				has_idea = Liyue_nationwide_resistance_1
				has_idea = Liyue_nationwide_resistance_2
				has_idea = Liyue_nationwide_resistance_3
				has_idea = Liyue_nationwide_resistance_4
				has_idea = Liyue_nationwide_resistance_5
			}
		}
		fire_only_once = no
		cancel_trigger = {
			NOT = { has_idea = Liyue_nationwide_resistance_1 }
			NOT = { has_idea = Liyue_nationwide_resistance_2 }
			NOT = { has_idea = Liyue_nationwide_resistance_3 }
			NOT = { has_idea = Liyue_nationwide_resistance_4 }
			NOT = { has_idea = Liyue_nationwide_resistance_5 }
		}
		timeout_effect = {
			hidden_effect = {
				activate_mission = liyue_rebellion_active
			}
			random_list = {
				seed = global.date
				15 = {
					modifier = {
						add = -5
						has_country_flag = lyu_reorganize_milita_flag
					}
					modifier = {
						factor = 1
						has_idea = Liyue_nationwide_resistance_1
					}
					modifier = {
						factor = 0.9
						has_idea = Liyue_nationwide_resistance_2
					}
					modifier = {
						factor = 0.7
						has_idea = Liyue_nationwide_resistance_3
					}
					modifier = {
						factor = 0.45
						has_idea = Liyue_nationwide_resistance_4
					}
					modifier = {
						factor = 0.15
						has_idea = Liyue_nationwide_resistance_5
					}
					add_stability = -0.025
				}
				45 = {
					modifier = {
						add = -5
						has_country_flag = countryside_rebuild
					}
					modifier = {
						add = -15
						has_country_flag = lyu_reorganize_milita_flag
					}
					modifier = {
						factor = 1
						has_idea = Liyue_nationwide_resistance_1
					}
					modifier = {
						factor = 0.9
						has_idea = Liyue_nationwide_resistance_2
					}
					modifier = {
						factor = 0.7
						has_idea = Liyue_nationwide_resistance_3
					}
					modifier = {
						factor = 0.45
						has_idea = Liyue_nationwide_resistance_4
					}
					modifier = {
						factor = 0.15
						has_idea = Liyue_nationwide_resistance_5
					}
					random_owned_state = {
						add_building_construction = {
							type = infrastructure
							level = -1
							instant_build = yes
						}
					}
				}
				40 = {
					modifier = {
						add = -5
						has_country_flag = countryside_rebuild
					}
					modifier = {
						add = -15
						has_country_flag = lyu_reorganize_milita_flag
					}
					modifier = {
						factor = 1
						has_idea = Liyue_nationwide_resistance_1
					}
					modifier = {
						factor = 0.95
						has_idea = Liyue_nationwide_resistance_2
					}
					modifier = {
						factor = 0.85
						has_idea = Liyue_nationwide_resistance_3
					}
					modifier = {
						factor = 0.7
						has_idea = Liyue_nationwide_resistance_4
					}
					modifier = {
						factor = 0.5
						has_idea = Liyue_nationwide_resistance_5
					}
					random_owned_state = {
						limit = {
							NOT = { is_core_of = ROOT }
						}
						add_resistance = 5
					}
				}
				4 = {
					modifier = {
						add = 4
						has_country_flag = countryside_rebuild
					}
					modifier = {
						add = 12
						has_country_flag = lyu_reorganize_milita_flag
					}
					modifier = {
						factor = 1.5
						has_country_flag = lyu_repair_road_flag
					}
					modifier = {
						factor = 1
						has_idea = Liyue_nationwide_resistance_1
					}
					modifier = {
						factor = 1.2
						has_idea = Liyue_nationwide_resistance_2
					}
					modifier = {
						factor = 1.6
						has_idea = Liyue_nationwide_resistance_3
					}
					modifier = {
						factor = 2
						has_idea = Liyue_nationwide_resistance_4
					}
					modifier = {
						factor = 2.5
						has_idea = Liyue_nationwide_resistance_5
					}
				}
				1 = {
					modifier = {
						add = 3
						has_country_flag = countryside_rebuild
					}
					modifier = {
						add = 6
						has_country_flag = lyu_reorganize_milita_flag
					}
					modifier = {
						factor = 2.5
						has_country_flag = lyu_repair_road_flag
					}
					modifier = {
						factor = 1
						has_idea = Liyue_nationwide_resistance_1
					}
					modifier = {
						factor = 1.2
						has_idea = Liyue_nationwide_resistance_2
					}
					modifier = {
						factor = 1.6
						has_idea = Liyue_nationwide_resistance_3
					}
					modifier = {
						factor = 2
						has_idea = Liyue_nationwide_resistance_4
					}
					modifier = {
						factor = 2.5
						has_idea = Liyue_nationwide_resistance_5
					}
					custom_effect_tooltip = lyu_failed_attack_tt
					#action failed
					hidden_effect = {
						add_to_variable = { LYU_days_rebellion_prepare_timeout = 1 }
						add_to_variable = { liyue_mil_reconstruction_progress = 5 }
					}
				}
			}
		}
		complete_effect = {
		}
	}
}