on_actions = {
	on_monthly_XOG = {
		effect = {
			#每月增加的业障度
			if = {
				limit = {
					has_country_flag = XOG_mechanism_mandrills   #每月检测业障度，增加buff		
				}
				XOG = { TTT_XOG_scripted_effects1 = yes	}	
				
				#检测业障是否超过100
				if = {
					limit = { check_variable = { XOG_yezhangdu > 99.9 } }
					every_country_division = {
						destroy_unit = yes
					}
					set_country_flag = XOG_yezhangdubaozha_flag
					clr_country_flag = XOG_mechanism_mandrills
					if = {
						limit = { has_dynamic_modifier = { modifier = XOG_yezhangdu_buff } }
						remove_dynamic_modifier = { modifier = XOG_yezhangdu_buff }
					}
					if = {
						limit = { NOT = { has_idea = XOG_aftermath } }
						add_ideas = XOG_aftermath
					}
				}
				
				if = {
					limit = { 
						any_country = {
							is_nominate_liyue = yes
							has_war_with = XOG
						}
					}
					add_to_variable = { XOG_yezhangdu = 2 }	# War with liyue warlords(include ZDG)
				}
				if = {
					limit = {
						has_war_with = ZDG
					}
					add_to_variable = { XOG_yezhangdu = -1 } # War with ZDG
				}
				if = {
					limit = {
						check_variable = { XOG_yezhangdu > 80 }
					}
					add_to_variable = { XOG_yezhangdu = 1 }
					if = {
						limit = {
							NOT = { has_country_flag = XOG_turn_bad }
						}
						set_country_flag = XOG_turn_bad
						load_focus_tree = XOG_bad_FocusTree
					}
				}
				add_to_variable = { XOG_yezhangdu = 1.0 }	#base
                clamp_variable = {
					var = XOG_yezhangdu
					max = 100.0
					min = 0.0
				}
				
				#每月触发随机事件——丘丘人作乱
				if = {
					limit = { NOT = { has_idea = XOG_furious_monsters } }
					if = {
						limit = {
							check_variable = { XOG_yezhangdu > 80 }
						}
						country_event = {
							id = XOG_events.3
						}	
					}
					else = {
						set_temp_variable = { XOG_yezhang_triggers = random }
						multiply_temp_variable = { XOG_yezhang_triggers = 100 }
						if = {
							limit = { 
								check_variable = { XOG_yezhangdu > XOG_yezhang_triggers }
							}
							country_event = {
								id = XOG_events.3
							}
						}
					}
				}
			}   			
		}	
	}
}