add_namespace = LHPG

#These are events about Liyue Harbor government.

country_event = {
	id = LHPG.1
	title = LHPG.1.t
	desc = LHPG.1.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.1.a
		ai_chance = {
			base = 10

			modifier = {
				add = 10
				NNG = {
					surrender_progress > 0.1
				}
			}
			modifier = {
				add = 5
				NNG = {
					num_of_factories < LYU.num_of_factories
				}
			}
			modifier = {
				add = 5
				NNG = {
					num_divisions < LYU.num_divisions
				}
			}
		}
		LYU = {
			country_event = {
				id = LHPG.2
				days = 4
			}
		}
	}

	option = { 
		name = LHPG.1.b
		ai_chance = {
			base = 5
		}
		add_stability = -0.15
		add_war_support = -0.15
		LYU = {
			country_event = {
				id = LHPG.3
				days = 4
			}
		}
	}

}

country_event = {
	id = LHPG.2
	title = LHPG.2.t
	desc = LHPG.2.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.1.a
		add_to_variable = {
					var = troika_prestige^0
					value = 2
				} #烟绯威望
		remove_ideas = blocked_harbour
		add_stability = 0.05
	}

}

country_event = {
	id = LHPG.3
	title = LHPG.3.t
	desc = LHPG.3.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.3.a
		add_war_support = 0.1
	}

}

country_event = {
	id = LHPG.4
	title = LHPG.4.t
	desc = LHPG.4.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.4.a
		trigger = {
			NOT = {
				has_country_flag = Yanfei_assassinated #不被刺杀
			}
			OR = {
				check_variable = { #如果是第一
					var = troika_cha_array^0
					value = 0
					compare = equals
				}
				AND = {
					check_variable = { troika_prestige_array^0 = troika_prestige_array^1 }
					check_variable = { troika_cha_array^1 = 0 } #如果第一和第二相等，且为第二
				}
				AND = {
					check_variable = { troika_prestige_array^0 = troika_prestige_array^2 }
					check_variable = { troika_cha_array^2 = 0 } #如果第一和第三相等，且为第三
				}
				AND = { #如果其他人被刺杀并且被刺杀的是第一
					OR = {
						AND = {
							has_country_flag = Ganyu_assassinated 
							check_variable = { troika_cha_array^0 = 1 }
						}
						AND = {
							has_country_flag = Baizhu_assassinated 
							check_variable = { troika_cha_array^0 = 2 }
						}
					}
					OR = { 
						check_variable = { troika_cha_array^1 = 0 }
						AND = {
							check_variable = { troika_prestige_array^1 = troika_prestige_array^2 }
							check_variable = { troika_cha_array^2 = 0 } #如果第二和第三相等，且为第三
						}
					}
					
				}
        	}
		}
		retire_character = LYU_troika
		LYU_yanfei = {
			promote_character = yes
			
		}
		set_politics = {
			ruling_party = authoritarianism
			elections_allowed = no
		}
		set_party_name = { 
            ideology = reformism
            long_name = LH_party_Yuehaiting_long 
            name = LH_party_Yuehaiting
        }
		set_party_name = { 
            ideology = authoritarianism
            long_name = LH_party_Yanfei_clique_long 
            name = LH_party_Yanfei_clique
        }
		set_party_name = { 
            ideology = despotism
            long_name = LH_party_Baizhu_clique_long 
            name = LH_party_Baizhu_clique 
        }
		hidden_effect = {
		set_country_flag = yanfei_victory
		news_event = {
			    id = global_news.24#事件id
				days = 7#几天后触发
			}#此为触发世界新闻
			add_political_power = 100
			add_stability = 0.1
			clr_country_flag = jieshusantoutongmeng
			load_focus_tree = YFX
		}
	}

	option = { 
		name = LHPG.4.b
		trigger = {
			NOT = {
				has_country_flag = Ganyu_assassinated #不被刺杀
			}
			OR = {
				check_variable = { #如果是第一
					var = troika_cha_array^0 
					value = 1
					compare = equals
				}
				AND = {
					check_variable = { troika_prestige_array^0 = troika_prestige_array^1 }
					check_variable = { troika_cha_array^1 = 1 } #如果第一和第二相等，且为第二
				}
				AND = {
					check_variable = { troika_prestige_array^0 = troika_prestige_array^2 }
					check_variable = { troika_cha_array^2 = 1 } #如果第一和第三相等，且为第三
				}
				AND = { #如果其他人被刺杀并且被刺杀的是第一
					OR = {
						AND = {
							has_country_flag = Yanfei_assassinated 
							check_variable = { troika_cha_array^0 = 0 }
						}
						AND = {
							has_country_flag = Baizhu_assassinated 
							check_variable = { troika_cha_array^0 = 2 }
						}
					}
					OR = { 
						check_variable = { troika_cha_array^1 = 1 }
						AND = {
							check_variable = { troika_prestige_array^1 = troika_prestige_array^2 }
							check_variable = { troika_cha_array^2 = 1 } #如果第二和第三相等，且为第三
						}
					}
				}
        	}
        }
		retire_character = LYU_troika
		set_politics = {
	        ruling_party = reformism
            elections_allowed = no
        }
		set_party_name = { 
            ideology = reformism
            long_name = LH_party_Yuehaiting_long 
            name = LH_party_Yuehaiting
        }
		set_party_name = { 
            ideology = authoritarianism
            long_name = LH_party_Yanfei_clique_long 
            name = LH_party_Yanfei_clique
        }
		set_party_name = { 
            ideology = despotism
            long_name = LH_party_Baizhu_clique_long 
            name = LH_party_Baizhu_clique 
        }
		LYU_Ganyu = {
			promote_character = yes
		}
		remove_trait = {
			trait = sinner_ofLiyue
			character = LYU_Ganyu
		}
		add_trait = {
			trait = obey_rule_law
			character = LYU_Ganyu
		}
		hidden_effect = {
			set_popularities = {
				reformism = 40
				liberalism = 10
				authoritarianism = 25
				despotism = 25
			}
			set_country_flag = ganyu_victory
			news_event = {
			    id = global_news.25#事件id
				days = 7#几天后触发
			}#此为触发世界新闻
			add_political_power = 100
			add_stability = 0.1
			load_focus_tree = GAN
			clr_country_flag = jieshusantoutongmeng
		}
	}

	option = { 
		name = LHPG.4.c
		trigger = {
			NOT = {
				has_country_flag = Baizhu_assassinated #不被刺杀
			}
			OR = {
				check_variable = { #如果是第一
					var = troika_cha_array^0
					value = 2
					compare = equals
				}
				AND = {
					check_variable = { troika_prestige_array^0 = troika_prestige_array^1 }
					check_variable = { troika_cha_array^1 = 2 } #如果第一和第二相等，且为第二
				}
				AND = {
					check_variable = { troika_prestige_array^0 = troika_prestige_array^2 }
					check_variable = { troika_cha_array^2 = 2 } #如果第一和第三相等，且为第三
				}
				AND = { #如果其他人被刺杀并且被刺杀的是第一
					OR = {
						AND = {
							has_country_flag = Yanfei_assassinated 
							check_variable = { troika_cha_array^0 = 0 }
						}
						AND = {
							has_country_flag = Ganyu_assassinated 
							check_variable = { troika_cha_array^0 = 1 }
						}
					}
					OR = { 
						check_variable = { troika_cha_array^1 = 2 }
						AND = {
							check_variable = { troika_prestige_array^1 = troika_prestige_array^2 }
							check_variable = { troika_cha_array^2 = 2 } #如果第二和第三相等，且为第三
						}
					}
				}
        	}
        }
		LYU_baizhu = {
			promote_character = yes
			
		}
		
		set_politics = {
			ruling_party = despotism
			elections_allowed = no
		}
		set_party_name = { 
            ideology = reformism
            long_name = LH_party_Yuehaiting_long 
            name = LH_party_Yuehaiting
        }
		set_party_name = { 
            ideology = authoritarianism
            long_name = LH_party_Yanfei_clique_long 
            name = LH_party_Yanfei_clique
        }
		set_party_name = { 
            ideology = despotism
            long_name = LH_party_Baizhu_clique_long 
            name = LH_party_Baizhu_clique 
        }
		set_country_flag = baizhu_victory
		hidden_effect = {
			set_popularities = {
				reformism = 20
				despotism = 40
				authoritarianism = 20
				communism = 10
				
				liberalism = 10
			}
		news_event = {
			    id = global_news.26#事件id
				days = 7#几天后触发
			}#此为触发世界新闻
			add_political_power = 100
			add_stability = 0.1
			clr_country_flag = jieshusantoutongmeng
		}
	}

}

country_event = {
	id = LHPG.5
	title = LHPG.5.t
	desc = LHPG.5.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.5.a
	
	}

}

country_event = {
	id = LHPG.6
	title = LHPG.6.t
	desc = LHPG.6.d

	fire_only_once = yes
	trigger = {
		has_completed_focus = LH_zaici_junshi_gaige
		NOT = { has_idea = LH_quanmian_military_reform }
	}
    
	hidden = yes

	option = { 
		name = LHPG.6.a
	    add_ideas = LH_Baizhu_military_reform
	}

}

country_event = {
	id = LHPG.7
	title = LHPG.7.t
	desc = LHPG.7.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.7.a
		ai_chance = {
			base = 5
			modifier = {
				add = 5
				has_completed_focus = LH_ZhaiXing
			}
			modifier = {
				factor = 0
				has_completed_focus = LH_Chongyang
			}
		}
	    LYU = {
			country_event = {
				id = LHPG.8
				days = 3
			}
		}
	}

	option = { 
		name = LHPG.7.b
		ai_chance = {
			base = 5
		}
	    LYU = {
			country_event = {
				id = LHPG.9
				days = 3
			}
		}
	}

}

country_event = {
	id = LHPG.8
	title = LHPG.8.t
	desc = LHPG.8.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.8.a
		add_to_variable = {
					var = troika_prestige^1
					value = 2
				} #甘雨威望
	    add_political_power = -100
		remove_ideas = unstable_mora_system
		XRG = {
			add_opinion_modifier = {
                target = LYU
                modifier = Liyue_Harbor_dip9
            }
		}
		LYU = {
			add_opinion_modifier = {
                target = XRG
                modifier = Liyue_Harbor_dip9
            }
		}
	}

}

country_event = {
	id = LHPG.9
	title = LHPG.9.t
	desc = LHPG.9.d

	fire_only_once = yes
	is_triggered_only = yes

	option = { 
		name = LHPG.9.a
		XRG = {
			add_opinion_modifier = {
                target = LYU
                modifier = Liyue_Harbor_dip10
            }
		}
		LYU = {
			add_opinion_modifier = {
                target = XRG
                modifier = Liyue_Harbor_dip10
            }
		}
	}

}
